#!/usr/bin/python3
from time import sleep
import logging
import sys

from modules.malware.check_process import get_pids

if __name__ == '__main__':
    FORMAT = '[%(asctime)s] [%(levelname)-8s] [%(message)s]'
    # filename='/tmp/cc.log'
    logging.basicConfig(stream=sys.stdout, format=FORMAT, level=logging.INFO)
    while True:
        logging.info('üëÆ watching ')
        sleep(5)
        malware_pids = get_pids('*mclient$')
        #print(get_pids('*mclient$'))
        if malware_pids != []:
            logging.info(f'üïµÔ∏è found potential threat! [{malware_pids}]')
            for t in range(30,0, -1):
                sys.stdout.write(f'\r\t\t\t\t    > ‚è∞ evaluating (remaining: {t}s)')
                sys.stdout.flush()
                sleep(1)
            