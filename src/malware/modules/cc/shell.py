from ..client import Client
from threading import Thread
from time import sleep

def cmd(client):
    cmd = ''
    while cmd != 'exit':
        sleep(2)
        while client.get_stdout_queue().qsize():
            print(client.get_stdout_queue().get())
            sleep(1)
        cmd = input('$ ')
        client.get_stdin_queue().put(cmd)
        #test(client)
    print("Exit ...")


# def test(client):
#     client.stdout.put("A")
#     client.stdout.put("B")
#     client.stdout.put("C")
            
def shell_main(clients, client_list_lock):
    try:
        for name,client in clients.items():
            print("Targetname: "+name)
            t = Thread(target=cmd, args=(client,))
            t.start()
    except KeyboardInterrupt:
        exit(-1)

